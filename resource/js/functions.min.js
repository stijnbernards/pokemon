function coords(e,t){this.X=0,this.Y=0,this.setX=function(e){this.X+=e,$gameWrapper.css("left",64*(-this.X+8))},this.setY=function(e){this.Y+=e,$gameWrapper.css("top",64*(-this.Y+6))},this.getBoth=function(){return jQuery.extend(!0,{},[this.X,this.Y])},this.setX(e),this.setY(t),setTimeout(function(){$gameWrapper.attr("data-animate","true")},50)}function character(e,t){this.bag=[],this.bagPkmn=[],this.pcPkmn=[];var a,e=e,o=t,n=1e3;this.pokemon={nN:255,name:"Torchic",species:"Chick Pok?mon",height:"1?4? (0.41m)",weight:"5.5 lbs (2.5 kg)",abilities:[],base_stats:{HP:[45,31,0],ATT:[60,31,0],DEF:[40,31,0],SPATT:[70,31,0],SPDEF:[50,31,0],SPD:[45,31,0]},stats:{HP:[],ATT:[],DEF:[],SPATT:[],SPDEF:[],SPD:[]},entry:"TORCHIC has a place inside its body where it keeps its flame. Give it a hug - it will be glowing with warmth. This POK?MON is covered all over by a fluffy coat of down.",moves:[["Scratch","Normal","Physical","tough",35,35,40,100]],level:2,exp:9,nature:0,expGroup:"Medium Slow",baseExp:"65",evYield:"1 Special Attack"},this.direction=null,$gameDiv.append('<div id="player"></div>'),a=$gameWrapper.find("#player"),this.getPlayerDiv=function(){return a},this.getCoords=function(){return jQuery.extend(!0,{},e)},this.getName=function(){return o},this.setX=function(t){e.setX(t)},this.setY=function(t){e.setY(t)},this.getMoney=function(){return n},this.setMoney=function(e){n+=e},this.showCoords=function(){console.log(e)},this.getItemByName=function(e){for(var t=0;t<this.bag.length;t++)if(this.bag[t].name===e)return this.bag[t]},this.getItemAmount=function(e){var t=jQuery.extend(!0,{},this.getItemByName(e)).amount;return void 0==t||"undefined"===t?0:t}}function isFunction(e){var t={};return e&&"[object Function]"===t.toString.call(e)}var resFolder="resource/images/",$gameDiv,$gameWrapper,maps=["maps/towns/littleroot/main.js","maps/towns/littleroot/player_home_f1.js","maps/towns/littleroot/player_home_f2.js","maps/towns/littleroot/rival_home_f1.js","maps/towns/littleroot/rival_home_f2.js","maps/towns/littleroot/laboratory.js","maps/routes/101/main.js","maps/towns/oldale_town/main.js","maps/towns/buildings/pokemart.js","maps/routes/103/main.js","maps/routes/102/main.js","maps/towns/oldale_town/house_1.js","maps/towns/oldale_town/house_2.js","maps/towns/petalburg_city/main.js"];$(document).ready(function(){$gameDiv=$("#game"),$gameWrapper=$("#game .parent.wrapper")});var pokemonCore={canKeyPress:!0,timeouts:[],displayGrid:!1,gameChar:null,specialInteract:[12],specialItems:[4,5],specialRender:{6:function(e,t){$gameWrapper.append('<div class="flower-1" style="top: '+64*e+"px; left: "+64*t+'px"></div>')}},passable:[0,6,2,7,8,9],init:function(){pokemonCore.maps.getMap(6),pokemonCore.player.bindMovement()},maps:{mapLastCoord:new Array,map:null,getMap:function(e){for(var t=0;t<pokemonCore.timeouts.length;t++)clearTimeout(pokemonCore.timeouts[t]);pokemonCore.timeouts=[],$.getScript("resource/"+maps[e],function(){pokemonCore.gameChar=null,$gameWrapper.attr("data-animate","false"),$gameWrapper.css("left",""),$gameWrapper.css("top",""),$gameWrapper.children().remove(),$("#player").remove(),$(".speech").remove(),$gameWrapper.append('<img class="bg">'),$gameWrapper.find(".bg").attr("src",resFolder+map[1]),pokemonCore.maps.map=map[0];for(var t=0;t<pokemonCore.maps.map.length;t++)for(var a=0;a<pokemonCore.maps.map[t].length;a++){var o=pokemonCore.maps.map[t][a];isFunction(pokemonCore.specialRender[o])?pokemonCore.specialRender[o](t,a):8==o&&null==pokemonCore.maps.mapLastCoord[e]&&pokemonCore.player.createPlayerAt(a+1,t+1)}if(null!=pokemonCore.maps.mapLastCoord[e]&&(pokemonCore.player.createPlayerAt(pokemonCore.maps.mapLastCoord[e].X,pokemonCore.maps.mapLastCoord[e].Y),pokemonCore.maps.mapLastCoord[e]=null),pokemonCore.displayGrid&&$gameWrapper.append('<div class="grid"></div>'),"undefined"!=typeof npc&&null!=npc)for(var n=0;n<npc.length;n++)npc[n].createNpc()})}},player:{walkInterval:null,lastKeyPress:null,initPokemons:function(){var e=0;$("#game").append('<div class="pokemons"><div class="info-box">Choose a POK&eacute;MON.</div></div>');for(var t=0;6>t;t++)$(".pokemons").append('<div class="pokemon-'+t+'" data-selected="'+(0==t?"true":"false")+'"><div class="sprite"></div><div class="health-bar"></div><div class="name"></div><div class="level"></div><div class="health"></div></div>');for(var t=0;t<pokemonCore.gameChar.bagPkmn.length+1;t++){var a=0==t?pokemonCore.gameChar.pokemon:pokemonCore.gameChar.bagPkmn[t-1],o=$(".pokemons .pokemon-"+t);o.attr("data-empty","false"),o.find(".name").text(a.name),o.find(".level").text("Lv"+a.level),o.find(".health").text(a.stats.HP[1]+"/ "+a.stats.HP[0]),o.find(".health-bar").css("width",a.stats.HP[1]/(a.stats.HP[0]/100)*1.92+"px")}$(document).unbind("keydown"),$(document).bind("keydown",function(t){var a=$('.pokemons div[data-selected="true"]'),o=0==e?pokemonCore.gameChar.pokemon:pokemonCore.gameChar.bagPkmn[e-1];switch(t.which){case 38:e=0==e?e=pokemonCore.gameChar.bagPkmn.length:e--,a.attr("data-selected","false"),$(".pokemons .pokemon-"+e).attr("data-selected","true");break;case 40:e=e==pokemonCore.gameChar.bagPkmn.length?e=0:e++,a.attr("data-selected","false"),$(".pokemons .pokemon-"+e).attr("data-selected","true");break;case 32:var n=1;$(".info-box").text("Do what with "+o.name+"?"),$(".pokemons").append('<div class="menu-box"><span data-selected="true">Shift</span><span>Summary</span><span>Cancel</span></div>'),$(document).unbind("keydown"),$(document).bind("keydown",function(t){switch(t.which){case 38:n=1==n?n=3:n-=1,$('.menu-box span[data-selected="true"]').attr("data-selected","false"),$(".menu-box span:nth-of-type("+n+")").attr("data-selected","true");break;case 40:n=3==n?n=1:n+=1,$('.menu-box span[data-selected="true"]').attr("data-selected","false"),$(".menu-box span:nth-of-type("+n+")").attr("data-selected","true");break;case 32:switch(console.log($('.menu-box span[data-selected="true"]').text()),$('.menu-box span[data-selected="true"]').text()){case"Shift":if(0!=e){var a=pokemonCore.gameChar.pokemon;pokemonCore.gameChar.bagPkmn.splice(pokemonCore.gameChar.bagPkmn.indexOf(o),1),pokemonCore.gameChar.bagPkmn.push(a),pokemonCore.gameChar.pokemon=o,$(document).unbind("keydown"),$(".pokemons").remove(),$(".action-menu").text(""),pokemonCore.utils.writer(0,function(){setTimeout(function(){$(".action-menu").text(""),pokemonCore.utils.writer(0,function(){$(".action-menu").append('<div class="action-box"><span class="fight" data-selected="true">FIGHT</span><span class="bag" data-selected="false">BAG</span><span class="pokemon" data-selected="false">POK&eacute;MON</span><span class="run" data-selected="false">RUN</span></div>'),pokemonCore.battle.setBattleKeybinds(".action-box"),$(".ally-pokemon").css("background-image","url(resource/images/pokemon/"+pokemonCore.gameChar.pokemon.nN+".png)"),$(".ally-health .pokemon-name").text(pokemonCore.gameChar.pokemon.name),$(".ally-health .pokemon-lvl").text("Lv:"+pokemonCore.gameChar.pokemon.level),$(".ally-health .pokemon-health").text(pokemonCore.gameChar.pokemon.stats.HP[0]+'/ <span class="cur-health"></span>'),$(".ally-health .pokemon-health .cur-health").text(pokemonCore.gameChar.pokemon.stats.HP[1])},"Go "+pokemonCore.gameChar.pokemon.name+"!")},700)},"That's enough "+a.name+" switch out!")}else $(".pokemons .info-box").text(o.name+" is already in battle!");break;case"Summary":break;case"Cancel":}}})}})},initBag:function(e){function t(){n=0,$(".bag-gui .items").remove(),$(".bag-gui .bag").attr("data-selected","-1"),$(".bag-gui .bag").attr("data-animate","true"),setTimeout(function(){$(".bag-gui .bag").attr("data-selected",r),$(".bag-gui .bag").attr("data-animate","false")},200),$(".bag-gui").append('<div class="items"></div>');for(var e in s[m[r]])$(".bag-gui .items").append('<div class="item"><span class="item-name">'+s[m[r]][e].name+'</span><span class="amount">x '+s[m[r]][e].amount+"</span></div>");$(".bag-gui .items .item:first-of-type").attr("data-selected","true")}function a(){var e=s[m[r]][n],t=e.img;"undefined"===t&&(t=e.name),$(".bag-gui .item-desc").text(""),$(".bag-gui .item-desc").append(e.desc),$(".bag-gui .item-display").css("background-image","url(resource/images/items/"+t+".png)")}function o(){$(document).bind("keydown",function(p){function i(){$(".arrow-left, .arrow-right").css("display","none"),setTimeout(function(){$(".arrow-left, .arrow-right").css("display","block")},200)}switch(p.which){case 39:r++,i(),r>4?($(".bag-gui .type-name span:first-of-type").next().css("margin-left","-"+268*r+"px"),setTimeout(function(){$(".bag-gui .type-name span:first-of-type").next().attr("data-animate","false"),$(".bag-gui .type-name span:first-of-type").next().css("margin-left","0px"),setTimeout(function(){$(".bag-gui .type-name span:first-of-type").next().attr("data-animate","true")},20)},200),r=0):$(".bag-gui .type-name span:first-of-type").next().css("margin-left","-"+268*r+"px"),$(".bag-gui .pokeball-icon").attr("data-animate","none"),setTimeout(function(){$(".bag-gui .pokeball-icon").attr("data-animate","right")},20),t();break;case 37:r--,i(),-1==r?($(".bag-gui .type-name span:first-of-type").next().attr("data-animate","false"),$(".bag-gui .type-name span:first-of-type").next().css("margin-left","-1340px"),setTimeout(function(){$(".bag-gui .type-name span:first-of-type").next().attr("data-animate","true"),$(".bag-gui .type-name span:first-of-type").next().css("margin-left","-1072px")},20),r=4):$(".bag-gui .type-name span:first-of-type").next().css("margin-left","-"+268*r+"px"),$(".bag-gui .pokeball-icon").attr("data-animate","none"),setTimeout(function(){$(".bag-gui .pokeball-icon").attr("data-animate","left")},20),t();break;case 38:if(n--,0>n)n=$(".bag-gui .items .item").length-1,$('.bag-gui .items .item[data-selected="true"]').attr("data-selected","false"),$(".bag-gui .items .item:last-of-type").attr("data-selected","true");else{var l=$('.bag-gui .items .item[data-selected="true"]');l.attr("data-selected","false"),l.prev().attr("data-selected","true")}a();break;case 40:if(n++,n>=$(".bag-gui .items .item").length)n=0,$('.bag-gui .items .item[data-selected="true"]').attr("data-selected","false"),$(".bag-gui .items .item:first-of-type").attr("data-selected","true");else{var l=$('.bag-gui .items .item[data-selected="true"]');l.attr("data-selected","false"),l.next().attr("data-selected","true")}a();break;case 17:$(".bag-gui").remove(),$(".game-menu").remove(),pokemonCore.player.openMenu();break;case 32:e?($(".bag-gui").append('<div class="use-item"></div>'),$(".bag-gui .use-item").append('<div data-selected="true" >Use</div><div>Cancel</div>'),$(document).unbind("keydown"),console.log(s[m[r]][n].name),"Close bag"===s[m[r]][n].name?($(".bag-gui").remove(),pokemonCore.battle.setBattleKeybinds(".action-box")):$(document).bind("keydown",function(e){var t=$('.bag-gui .use-item div[data-selected="true"]');switch(e.which){case 32:switch(t.text()){case"UseUse":s[m[r]][n].use();break;case"CancelCancel":$(".bag-gui .use-item").remove(),o()}break;case 38:console.log($('.bag-gui .use-item div:last-of-type[data-selected="true"]').length),$('.bag-gui .use-item div:last-of-type[data-selected="true"]').length>-1?$(".bag-gui .use-item div:first-of-type").attr("data-selected","true"):t.next().attr("data-selected","true"),t.attr("data-selected","false");break;case 40:console.log($('.bag-gui .use-item div:first-of-type[data-selected="true"]').length),$('.bag-gui .use-item div:first-of-type[data-selected="true"]').length>-1?$(".bag-gui .use-item div:last-of-type").attr("data-selected","true"):t.prev().attr("data-selected","true"),t.attr("data-selected","false");break;case 17:$(".bag-gui .use-item").remove(),o()}})):s[m[r]][n].use()}p.preventDefault()})}var n=0,r=0,s={ITEMS:[],"POK&eacute; BALLS":[],"TMs & HMs":[],BERRIES:[],"KEY ITEMS":[]},m=[];for(var p in s)m.push(p);$("#game").append('<div class="bag-gui"><div class="bag" data-selected="0"></div><div class="pokeball-icon"></div><div class="arrow-left"></div><div class="arrow-right"></div><div class="type-name"></div><div class="item-display"></div><div class="item-desc"></div></div>'),$(".bag-gui .type-name").append('<span style="margin-left: -268px">KEY ITEMS</span><span data-animate="true">ITEMS</span><span>POK&eacute; BALLS</span><span>TMs & HMs</span><span>BERRIES</span><span>KEY ITEMS</span><span>ITEMS</span>');for(var i in pokemonCore.gameChar.bag)s[pokemonCore.gameChar.bag[i].type].push(pokemonCore.gameChar.bag[i]);for(var l=0;l<m.length;l++)s[m[l]].push(new pokemonCore.item("Close bag",function(){$(".bag-gui").remove(),$(".game-menu").remove(),pokemonCore.player.openMenu()},"","Return to the field.","quit"));t(),a(),o()},openMenu:function(){var e={"POK&eacute;DEX":function(){},"POK&eacute;MON":function(){},BAG:function(){$(document).unbind("keydown"),pokemonCore.player.initBag()},"char":function(){},SAVE:function(){},OPTION:function(){},EXIT:function(){$(document).unbind("keydown"),$(".game-menu").remove(),pokemonCore.player.bindMovement()}};$(document).unbind("keydown"),$("#game").append('<div class="game-menu"></div>');for(var t in e)e.hasOwnProperty(t)&&$(".game-menu").append("char"===t?'<div data-func="'+t+'">'+pokemonCore.gameChar.getName()+"</div>":'<div data-func="'+t+'">'+t+"</div>");$(".game-menu div:first-of-type").attr("data-selected","true"),$(document).bind("keydown",function(t){var a=$('.game-menu div[data-selected="true"]');switch(t.which){case 38:a.prev().length>0?(a.attr("data-selected","false"),a.prev().attr("data-selected","true")):(a.attr("data-selected","false"),$(".game-menu div:last-of-type").attr("data-selected","true"));break;case 40:a.next().length>0?(a.attr("data-selected","false"),a.next().attr("data-selected","true")):(a.attr("data-selected","false"),$(".game-menu div:first-of-type").attr("data-selected","true"));break;case 32:e[a.attr("data-func")]();break;case 13:e.EXIT()}})},createPlayerAt:function(e,t){pokemonCore.gameChar=new character(new coords(e,t),"Peter"),pokemonCore.pokemon.calcPokemonStats(pokemonCore.gameChar.pokemon)},bindMovement:function(){$(document).keydown(function(e){function t(){switch(e.which){case 37:pokemonCore.gameChar.direction="left",$("#player").attr("data-direction","left"),pokemonCore.player.checkMove(-1,0)&&(pokemonCore.gameChar.setX(-1),$("#player").attr("data-animate","true"),pokemonCore.canKeyPress=!1,a());break;case 38:pokemonCore.gameChar.direction="up",$("#player").attr("data-direction","up"),pokemonCore.player.checkMove(0,-1)&&(pokemonCore.gameChar.setY(-1),$("#player").attr("data-animate","true"),pokemonCore.canKeyPress=!1,a());break;case 39:pokemonCore.gameChar.direction="right",$("#player").attr("data-direction","right"),pokemonCore.player.checkMove(1,0)&&(pokemonCore.gameChar.setX(1),$("#player").attr("data-animate","true"),pokemonCore.canKeyPress=!1,a());break;case 40:pokemonCore.gameChar.direction="down",$("#player").attr("data-direction","down"),pokemonCore.player.checkMove(0,1)&&(pokemonCore.gameChar.setY(1),$("#player").attr("data-animate","true"),pokemonCore.canKeyPress=!1,a());break;case 32:clearInterval(pokemonCore.player.walkInterval),pokemonCore.player.walkInterval=null,pokemonCore.player.checkInteract();break;case 13:pokemonCore.player.openMenu();break;default:return}}function a(){"left"===$("#player").attr("data-foot")?$("#player").attr("data-foot","right"):$("#player").attr("data-foot","left")}("null"===pokemonCore.player.walkInterval||null==pokemonCore.player.walkInterval)&&(t(),0==pokemonCore.canKeyPress&&setTimeout(function(){setTimeout(function(){$("#player").attr("data-animate","false"),pokemonCore.canKeyPress=!0},100)},150),function o(){32!=e.which&&(pokemonCore.player.lastKeyPress=e.which,pokemonCore.player.walkInterval=setTimeout(function(){t(),0==pokemonCore.canKeyPress&&setTimeout(function(){setTimeout(function(){$("#player").attr("data-animate","false"),pokemonCore.canKeyPress=!0},100)},150),o()},280))}()),e.preventDefault()}),$(document).bind("keyup",function(e){e.which==pokemonCore.player.lastKeyPress&&(clearInterval(pokemonCore.player.walkInterval),pokemonCore.player.walkInterval=null)})},checkMove:function(e,t){var a=pokemonCore.gameChar.getCoords();if(a.X+=e,a.Y+=t,pokemonCore.passable.indexOf(pokemonCore.maps.map[a.Y-1][a.X-1])>=0){if("9"==pokemonCore.maps.map[a.Y-1][a.X-1])return pokemonCore.battle.grassTrigger(),!0;if("undefined"!=typeof npc&&null!=npc)for(var o=0;o<npc.length;o++)if(npc[o].getCoords()[0]==a.getBoth()[0]&&npc[o].getCoords()[1]==a.getBoth()[1])return!1;return!0}if(!(pokemonCore.passable.indexOf(pokemonCore.maps.map[a.Y-1][a.X-1][0])>=0))return pokemonCore.specialItems.indexOf(pokemonCore.maps.map[a.Y-1][a.X-1][0])>=0&&pokemonCore.maps.map[a.Y-1][a.X-1][1](),!1;if(2!=pokemonCore.maps.map[a.Y-1][a.X-1][0])return pokemonCore.maps.map[a.Y-1][a.X-1][1](),!1;if(pokemonCore.gameChar.direction==pokemonCore.maps.map[a.Y-1][a.X-1][1]){switch(pokemonCore.gameChar.direction){case"left":pokemonCore.gameChar.setX(-1);break;case"right":pokemonCore.gameChar.setX(1);break;case"down":pokemonCore.gameChar.setY(1);break;case"up":pokemonCore.gameChar.setY(-1)}return!0}},checkInteract:function(){var e,t,a,o=pokemonCore.gameChar.getCoords();switch(a=!1,pokemonCore.gameChar.direction){case"left":e=-1,t=0;break;case"right":e=1,t=0;break;case"down":e=0,t=1;break;case"up":e=0,t=-1;break;default:e=0,t=0}if(o.X+=e,o.Y+=t,"undefined"!=typeof npc)for(var n=0;n<npc.length;n++)npc[n].getCoords()[0]==o.getBoth()[0]&&npc[n].getCoords()[1]==o.getBoth()[1]&&(npc[n].interact(),a=!0);return 0==a&&"12"==pokemonCore.maps.map[o.Y-1][o.X-1][0]&&pokemonCore.maps.map[o.Y-1][o.X-1][1](),!0}},npc:function(e,t,a,o,n,r,s,m,p,i,l){function c(e,a){f[0]+=e,f[1]+=a,$(".npc-"+t).css({top:64*(f[1]-1)+"px",left:64*(f[0]-1)+"px"}),1==e?g="right":-1==e?g="left":1==a?g="down":-1==a&&(g="up"),$(".npc-"+t).attr("data-direction",g)}function u(){null==h||"false"!==p&&0!=p?!function e(){pokemonCore.timeouts.push(setTimeout(function(){if(v){var a,o,n=Math.floor(4*Math.random()),r=["up","down","left","right"];switch(g=r[n],p&&$(".npc-"+t).attr("data-direction",r[n]),g){case"left":a=-1,o=0;break;case"right":a=1,o=0;break;case"down":a=0,o=1;break;case"up":a=0,o=-1;break;default:a=0,o=0}"false"!==k.battle&&0!=k.battle&&d(a,o)}e()},500))}():!function a(){pokemonCore.timeouts.push(setTimeout(function(){if(v){var e=0,t=0;!function o(){Math.round(2*Math.random())-1==0?e=Math.floor(3*Math.random())+-1:t=Math.floor(3*Math.random())+-1,f[0]+e<=h[0][0]&&f[1]+t<=h[0][1]&&f[0]+e>=h[1][0]&&f[1]+t>=h[1][1]&&f[0]+e!=pokemonCore.gameChar.getCoords().X&&f[1]+t!=pokemonCore.gameChar.getCoords().Y?c(e,t):o()}()}a()},2e3))}()}function d(e,a){function o(){for(var e=0;e<r.length;e++)for(var t=0;t<r[e].length&&r[e][t]==s[t];t++)if(1==t)return n=r[e],!0;return!1}for(var n,r=[[parseInt(f[0])+e,parseInt(f[1])+a]],s=[pokemonCore.gameChar.getCoords().X,pokemonCore.gameChar.getCoords().Y],m=0;5>m;m++)r.push([parseInt(r[m][0])+e,parseInt(r[m][1])+a]);o()&&($(document).unbind("keydown"),v=!1,$(".npc-"+t).prepend('<div class="exclamation-mark"></div>'),setTimeout(function(){$(".npc-"+t+" .exclamation-mark").remove(),function o(){setTimeout(function(){c(e,a),f[0]!=s[0]-1&&f[1]!=s[1]-1&&f[0]!=s[0]+1&&f[1]!=s[1]+1?o():pokemonCore.utils.createDialog(k.dialog[k.curDialog],k)},300)}()},1e3))}var k=this,g=null,h=e;this.name=t,this.dialog=a;var C=s,f=s;this.battle=m;var v=!0;this.curDialog=0,this.clear=!1,this.shouldTurn=p,this.beforeFight=i,this.afterFight=l,this.getCoords=function(){return jQuery.extend(!0,{},f)},u(),this.interact=function(){switch($(".speech").remove(),v=!1,pokemonCore.gameChar.direction){case"up":g="down";break;case"left":g="right";break;case"down":g="up";break;case"right":g="left"}this.curDialog<this.dialog.length?pokemonCore.utils.createDialog(this.dialog[this.curDialog],this):(pokemonCore.player.bindMovement(),this.curDialog=0,v=!0)},this.createNpc=function(){$gameWrapper.append('<div class="npc npc-'+t+'" style="top: '+64*(C[1]-1)+"px; left: "+64*(C[0]-1)+"px; background-image: url("+this.name+'.png)" data-direction="up"></div>'),g="up"},this.pokemonAlive=function(){for(var e=0;e<pokemonCore.battle.trainerNpc.battle.pokemon.length;e++)if(pokemonCore.battle.trainerNpc.battle.pokemon[e].pokemon.pokemon.stats.HP[1]>0)return e;return!1}},utils:{pokeInfo:function(){},writer:function(e,t,a){setTimeout(function(){e<a.length?($(".action-menu").append(a[e]),e++,pokemonCore.utils.writer(e,t,a)):"undefined"!=typeof t&&t()},50)},createEmptyDialog:function(e){var t,a,o=!0;$gameDiv.append('<div class="speech" style="width: 100%; height: 160px;"></div>'),e.indexOf("<br>")>-1&&(t=e.indexOf("<br>"),e=e.replace("<br>","")),e.indexOf("&eacute;")>-1&&(a=e.indexOf("&eacute;"),e=e.replace("&eacute;","")),function n(r){setTimeout(function(){r<e.length&&o&&($(".speech").append(e[r]),r++,r==t?$(".speech").append("<br>"):r==a&&$(".speech").append("&eacute;"),n(r))},50)}(0)},createDialog:function(e,t){var a,o,n=!0;$(document).unbind("keydown"),$(document).unbind("keyup"),$gameDiv.append('<div class="speech" style="width: 100%; height: 160px;"></div>'),e.indexOf("<br>")>-1&&(a=e.indexOf("<br>"),e=e.replace("<br>","")),e.indexOf("&eacute;")>-1&&(o=e.indexOf("&eacute;"),e=e.replace("&eacute;","")),function r(t){setTimeout(function(){t<e.length&&n&&($(".speech").append(e[t]),t++,t==a?$(".speech").append("<br>"):t==o&&$(".speech").append("&eacute;"),r(t))},50)}(0),$(document).keydown(function(e){switch(e.which){case 32:$(document).unbind("keydown"),n=!1,t.curDialog++,"false"===t.battle||0==t.battle?t.interact():t.curDialog<t.dialog.length?pokemonCore.utils.createDialog(t.dialog[t.curDialog],t):(t.battle.pokemon[0].pokemon.pokemon.level=t.battle.pokemon[0].pokemon.level,pokemonCore.battle.trainerNpc=t,pokemonCore.battle.startBattleScreen(t.battle.pokemon[0].pokemon),pokemonCore.battle.isTrainer=!0,$(".speech").remove())}})}},battle:{trainerNpc:null,isTrainer:null,encounter:null,timesEscaped:0,grassTrigger:function(){for(var e=Math.random(),t=0,a=0;a<pokemon.length;a++){t+=pokemon[a].rarity/187.5;var o,n=Math.ceil(Math.random()*pokemon[a].level.length);if(t>e){pokemon[a].pokemon.level=n,o=pokemonCore.pokemon.genIvEv(pokemon[a]),o=pokemonCore.pokemon.instantiateMoves(pokemon[a]),pokemonCore.battle.startBattleScreen(o);break}}},startBattleScreen:function(e){function t(o,n,r){setTimeout(function(){o<n[r].length&&a?($(".action-menu").append(n[r][o]),o++,t(o,n,r)):setTimeout(function(){r++,r!=n.length?($(".action-menu").text(""),t(0,n,r)):pokemonCore.battle.initFight(e)},1e3)},50)}var a=!0;$(document).unbind("keydown"),$gameDiv.append('<div class="battle-screen" data-bg="cyan"></div>'),$(".battle-screen").append('<div class="action-menu" data-bg="start"></div>'),null==pokemonCore.battle.trainerNpc?t(0,["Wild "+e.pokemon.name+" appeared!","Go "+pokemonCore.gameChar.pokemon.name+"!","What will "+pokemonCore.gameChar.pokemon.name+" do?"],0):t(0,[pokemonCore.battle.trainerNpc.beforeFight[0],pokemonCore.battle.trainerNpc.name+" sent out "+e.pokemon.name+"!","Go "+pokemonCore.gameChar.pokemon.name+"!","What will "+pokemonCore.gameChar.pokemon.name+" do?"],0)},initFight:function(e){$(".action-menu").append('<div class="action-box"><span class="fight" data-selected="true">FIGHT</span><span class="bag" data-selected="false">BAG</span><span class="pokemon" data-selected="false">POK&eacute;MON</span><span class="run" data-selected="false">RUN</span></div>'),$(".battle-screen").append('<div class="enemy-health"><div class="health-bar"></div><span class="pokemon-name"></span><span class="pokemon-lvl"></span></div><div class="ally-health" data-active="true"><div class="exp-bar"></div><div class="health-bar"></div><span class="pokemon-name"></span><span class="pokemon-lvl"></span><span class="pokemon-health"><span class="cur-health"></span></span></div><div class="enemy-pokemon"></div><div class="ally-pokemon" data-selected="true"></div>'),$(".enemy-pokemon").css("background-image","url(resource/images/pokemon/"+e.pokemon.nN+".png)"),$(".ally-pokemon").css("background-image","url(resource/images/pokemon/"+pokemonCore.gameChar.pokemon.nN+".png)"),$(".enemy-health .pokemon-name").append(e.pokemon.name),$(".ally-health .pokemon-name").append(pokemonCore.gameChar.pokemon.name),$(".enemy-health .pokemon-lvl").append("Lv:"+e.pokemon.level),$(".ally-health .pokemon-lvl").append("Lv:"+pokemonCore.gameChar.pokemon.level),$(".ally-health .pokemon-health").prepend(pokemonCore.gameChar.pokemon.stats.HP[0]+"/ "),$(".ally-health .pokemon-health .cur-health").append(pokemonCore.gameChar.pokemon.stats.HP[1]),pokemonCore.battle.setBattleKeybinds(".action-box"),pokemonCore.battle.encounter=e,pokemonCore.battle.animateHealth(),$(".ally-health .exp-bar").css("width",2.59*pokemonCore.pokemon.calcPercentage(pokemonCore.gameChar.pokemon)+"px")},stopBattle:function(){$(".battle-screen").remove(),pokemonCore.battle.timesEscaped=0,pokemonCore.battle.encounter=null,pokemonCore.battle.isTrainer=null,pokemonCore.battle.trainerNpc=null},setBattleKeybinds:function(e){function t(){return $(e+' [data-selected="true"]').attr("class")}function a(){switch(t()){case"run":if(null==pokemonCore.battle.isTrainer){var e=pokemonCore.gameChar.pokemon.stats.SPD[1],a=pokemonCore.battle.encounter.pokemon.stats.SPD[1],n=pokemonCore.battle.timesEscaped,r=Math.round(255*Math.random()),s=32*e/a+30*n;return $(".action-menu").text(""),$(".action-box").remove(),pokemonCore.battle.timesEscaped++,s>r?pokemonCore.utils.writer(0,function(){setTimeout(function(){pokemonCore.battle.stopBattle(),$(document).unbind("keydown"),pokemonCore.player.bindMovement()},900)},"Got away safely!"):pokemonCore.utils.writer(0,function(){setTimeout(function(){pokemonCore.battle.enemyMove()},900)},"Couldn't get away!"),void console.log(n)}break;case"fight":return $(document).unbind("keydown"),void o();case"bag":return void pokemonCore.player.initBag(!0);case"pokemon":pokemonCore.player.initPokemons(!0)}t().indexOf("move")>=-1&&pokemonCore.battle.handleMove(t(),!1)}function o(){$(".battle-screen").append('<div class="fight-box"><div class="moves"><span class="move-1" data-selected="true"></span><span class="move-2" data-selected="false"></span><span class="move-3" data-selected="false"></span><span class="move-4" data-selected="false"></span></div></div>');for(var e=0;e<pokemonCore.gameChar.pokemon.moves.length;e++)$(".moves .move-"+(e+1)).append(pokemonCore.gameChar.pokemon.moves[e][0]);pokemonCore.battle.setBattleKeybinds(".moves")}$(document).keydown(function(o){var n=$(e+' [data-selected="true"]');switch(o.which){case 37:("bag"==t()||"run"==t()||"move-2"==t()||"move-4"==t())&&(n.attr("data-selected","false"),n.prev().attr("data-selected","true"));break;case 38:("pokemon"==t()||"run"==t()||"move-3"==t()||"move-4"==t())&&(n.attr("data-selected","false"),n.prev().prev().attr("data-selected","true"));break;case 39:("pokemon"==t()||"fight"==t()||"move-1"==t()||"move-3"==t())&&(n.attr("data-selected","false"),n.next().attr("data-selected","true"));break;case 40:("fight"==t()||"bag"==t()||"move-1"==t()||"move-2"==t())&&(n.attr("data-selected","false"),n.next().next().attr("data-selected","true"));break;case 32:a();break;default:return}o.preventDefault()})},handleMove:function(e,t){function a(e,t,n){setTimeout(function(){e<r.length?($(".action-menu").append(r[e]),e++,a(e,t,n)):t?o(s):"undefined"!=typeof n&&n()},50)}function o(e){pokemonCore.battle.animateHealth(e,t),t?setTimeout(function(){pokemonCore.gameChar.pokemon.stats.HP[1]<=0?($(".action-menu").text(""),r=pokemonCore.gameChar.pokemon.name+" fainted!",setTimeout(function(){$("body").remove()},2e3)):($(".action-menu").text(""),$(".action-menu").append('<div class="action-box"><span class="fight" data-selected="true">FIGHT</span><span class="bag" data-selected="false">BAG</span><span class="pokemon" data-selected="false">POK&eacute;MON</span><span class="run" data-selected="false">RUN</span></div>'),pokemonCore.battle.setBattleKeybinds(".action-box"),r="What will "+pokemonCore.gameChar.pokemon.name+" do?"),a(0,!1)},1e3):setTimeout(function(){if(pokemonCore.battle.encounter.pokemon.stats.HP[1]<=0)if("null"!==pokemonCore.battle.trainerNpc&&null!==pokemonCore.battle.trainerNpc){r=pokemonCore.battle.encounter.pokemon.name+" fainted!",pokemonCore.pokemon.awardEV(pokemonCore.battle.encounter.pokemon);var e=pokemonCore.battle.trainerNpc.pokemonAlive();e>0?(pokemonCore.battle.trainerNpc.battle.pokemon[e].pokemon.pokemon.level=pokemonCore.battle.trainerNpc.battle.pokemon[e].pokemon.level,$(".action-menu").text(""),a(0,!1,function(){pokemonCore.battle.expGain(!0,pokemonCore.gameChar.pokemon,pokemonCore.battle.encounter.pokemon,function(){r=pokemonCore.battle.trainerNpc.name+" send out "+pokemonCore.battle.trainerNpc.battle.pokemon[e].pokemon.pokemon.name,$(".action-menu").text(""),setTimeout(function(){$(".action-menu").text(""),a(0,!1,function(){r="What wil "+pokemonCore.gameChar.pokemon.name+" do?",setTimeout(function(){$(document).unbind("keydown"),$(".battle-screen").children().remove(),$(".battle-screen").append('<div class="action-menu" data-bg="start"></div>'),a(0,!1,function(){pokemonCore.battle.initFight(pokemonCore.battle.trainerNpc.battle.pokemon[e].pokemon)})},1e3)})},1e3)})})):(a(0,!1),pokemonCore.battle.encounter=null,setTimeout(function(){function e(a){setTimeout(function(){a<t.length?($(".action-menu").append(t[a]),a++,e(a)):setTimeout(function(){pokemonCore.battle.stopBattle(),$(document).unbind("keydown"),pokemonCore.player.bindMovement(),pokemonCore.battle.trainerNpc=null,pokemonCore.battle.isTrainer=!1},1e3)},50)}var t=pokemonCore.battle.trainerNpc.name+": "+pokemonCore.battle.trainerNpc.afterFight[0];$(".action-menu").text(""),e(0)},2e3))}else $(".action-menu").text(""),r=p.pokemon.name+" fainted!",pokemonCore.pokemon.awardEV(pokemonCore.battle.encounter.pokemon),a(0,!1,function(){pokemonCore.battle.expGain(!1,pokemonCore.gameChar.pokemon,pokemonCore.battle.encounter.pokemon,function(){setTimeout(function(){pokemonCore.battle.stopBattle(),$(document).unbind("keydown"),pokemonCore.player.bindMovement(),pokemonCore.battle.trainerNpc=null,pokemonCore.battle.isTrainer=!1},1e3)})});else pokemonCore.battle.enemyMove()},1e3)}var e=e,n=e;t||(n=e.substr(5)-1,pokemonCore.battle.timesEscaped=0);var r,s,m=pokemonCore.gameChar.pokemon,p=pokemonCore.battle.encounter;if(t){var i=["ATT","DEF"];s=Math.round((2*pokemonCore.battle.encounter.pokemon.level+10)/250*(pokemonCore.battle.encounter.pokemon.stats[i[0]][1]/pokemonCore.gameChar.pokemon.stats[i[1]][1])*pokemonCore.battle.encounter.pokemon.moves[e][6]+2)}else{var i=["ATT","DEF"];s=Math.round((2*pokemonCore.gameChar.pokemon.level+10)/250*(pokemonCore.gameChar.pokemon.stats[i[0]][1]/pokemonCore.battle.encounter.pokemon.stats[i[1]][1])*pokemonCore.gameChar.pokemon.moves[n][6]+2)}(t||!t&&m.moves[n][5]>0)&&($(document).unbind("keydown"),t||m.moves[n][5]--,t?m.stats.HP[1]-=s:p.pokemon.stats.HP[1]-=s,$(".action-menu").text(""),$(".fight-box").remove(),$(".action-box").remove(),r=t?p.pokemon.name+" used "+p.pokemon.moves[e][0]+"!":m.name+" used "+m.moves[n][0]+"!",a(0,!0))},expGain:function(e,t,a,o){var n,r=e?1.5:1,s=a.baseExp,m=1,p=1,i=a.level,l=(t.level,1),c=1,u=1,d=1,k=Math.round(r*u*s*m*i*l*p*d/(7*c));t.exp+=k,n=pokemonCore.pokemon.calcPercentage(t),$(".action-menu").text(""),$(".ally-health .exp-bar").css("width",2.59*n+"px"),pokemonCore.utils.writer(0,function(){setTimeout(function(){pokemonCore.pokemon.expForLevel(t.level+1,t.expGroup)<=t.exp?(t.level++,pokemonCore.battle.levelUpHandler(t,o)):o()},1e3)},t.name+" gained "+k+" EXP. Points!")},enemyMove:function(){var e=Math.floor(1*Math.random());pokemonCore.battle.handleMove(e,!0)},levelUpHandler:function(e,t){pokemonCore.pokemon.calcPokemonStats(pokemonCore.gameChar.pokemon),$(".action-menu").text(""),setTimeout(function(){pokemonCore.utils.writer(0,function(){var a=jQuery.extend(!0,{},e),o=jQuery.extend(!0,{},e),n=!0;o.level--;var r=[pokemonCore.pokemon.statNormFormula(a,"HP").stats.HP[0]-pokemonCore.pokemon.statNormFormula(o,"HP").stats.HP[0],pokemonCore.pokemon.statNormFormula(a,"ATT").stats.ATT[0]-pokemonCore.pokemon.statNormFormula(o,"ATT").stats.ATT[0],pokemonCore.pokemon.statNormFormula(a,"DEF").stats.DEF[0]-pokemonCore.pokemon.statNormFormula(o,"DEF").stats.DEF[0],pokemonCore.pokemon.statNormFormula(a,"SPATT").stats.SPATT[0]-pokemonCore.pokemon.statNormFormula(o,"SPATT").stats.SPATT[0],pokemonCore.pokemon.statNormFormula(a,"SPDEF").stats.SPDEF[0]-pokemonCore.pokemon.statNormFormula(o,"SPDEF").stats.SPDEF[0],pokemonCore.pokemon.statNormFormula(a,"SPD").stats.SPD[0]-pokemonCore.pokemon.statNormFormula(o,"SPD").stats.SPD[0]];
    $(".battle-screen").append('<div class="level-up"></div>');for(var s=0;s<r.length;s++)$(".level-up").append('<div class="level-'+s+'">'+r[s]+"</div>");$(document).bind("keydown",function(e){32==e.which&&(n?($(".level-up").css("background-image","url(resource/images/gui/battle/level_stats.png)"),$(".level-up .level-0").text(pokemonCore.gameChar.pokemon.stats.HP[0]),$(".level-up .level-1").text(pokemonCore.gameChar.pokemon.stats.ATT[0]),$(".level-up .level-2").text(pokemonCore.gameChar.pokemon.stats.DEF[0]),$(".level-up .level-3").text(pokemonCore.gameChar.pokemon.stats.SPATT[0]),$(".level-up .level-4").text(pokemonCore.gameChar.pokemon.stats.SPDEF[0]),$(".level-up .level-5").text(pokemonCore.gameChar.pokemon.stats.SPD[0]),n=!1):(t(),$(".level-up").remove()))})},e.name+" grew to LV."+e.level+"!")},200)},animateHealth:function(e,t){var a=$(".ally-health .health-bar"),o=$(".enemy-health .health-bar");t&&!function s(t){e>t&&setTimeout(function(){$(".ally-health .pokemon-health .cur-health").text($(".ally-health .pokemon-health .cur-health").text()-1),t++,s(t)},1e3/e)}(0);var n=194/pokemonCore.gameChar.pokemon.stats.HP[0]*pokemonCore.gameChar.pokemon.stats.HP[1],r=204/pokemonCore.battle.encounter.pokemon.stats.HP[0]*pokemonCore.battle.encounter.pokemon.stats.HP[1];$(a).css("width",n+"px"),$(o).css("width",r+"px")}},pokemon:{awardEV:function(e){var t,a,o=e.evYield.replace("Special Attack","SPATT");o=o.replace("Special Defense","SPDEF"),o=o.replace("Speed","SPD"),o=o.replace("Attack","ATT"),o=o.replace("Defense","DEF"),o=o.split(" ");for(var n=0;n<o.length;n+=2)t=o[n],a=o[n+1],console.log(t),console.log(a),pokemonCore.gameChar.pokemon.base_stats[a][2]+=parseInt(t)},calcPercentage:function(e){var t,a,o,n,r;return t=pokemonCore.pokemon.expForLevel(e.level,e.expGroup),a=pokemonCore.pokemon.expForLevel(e.level+1,e.expGroup),t=0>t?0:t,o=e.exp-t,n=a-t,r=o/(n/100),r>100&&(r=100),r},expForLevel:function(e,t){var a;switch(t){case"Erratic":a=Math.round(50>=e?Math.pow(e,3)*(100-e)/50:68>=e?Math.pow(e,3)*(150-e)/100:98>=e?Math.pow(e,3)*Math.floor((1911-10*e)/3)/500:100>=e?Math.pow(e,3)*(160-e)/100:0);break;case"Fluctuating":a=Math.round(15>=e?Math.pow(e,3)*((Math.floor((e+1)/3)+24)/50):36>=e?Math.pow(e,3)*((e+14)/50):100>=e?Math.pow(e,3)*((Math.floor(e/2)+32)/50):0);break;case"Slow":a=5*Math.pow(e,3)/4;break;case"Medium Slow":a=Math.round(1.2*Math.pow(e,3)-15*Math.pow(e,2)+100*e-140);break;case"Medium Fast":a=Math.round(Math.pow(e,3));break;case"Fast":a=Math.round(4*Math.pow(e,3)/5)}return a},instantiate:function(e){var e=e;return $.ajax({async:!1,url:"resource/pokemons/"+e+".js",dataType:"script"}),pokeInfo},instantiateMoves:function(e){for(var t=0;t<e.pokemon.moves.length;t++){var a=e.pokemon.moves[t];$.ajax({async:!1,url:"resource/moves/"+a+".js",dataType:"script"}),e.pokemon.moves[t]=move}return e},genIvEv:function(e){var t;return t="undefined"!=typeof e.pokemon?e.pokemon:e,t.base_stats.HP[1]=Math.floor(31*Math.random()+1),t.base_stats.ATT[1]=Math.floor(31*Math.random()+1),t.base_stats.DEF[1]=Math.floor(31*Math.random()+1),t.base_stats.SPATT[1]=Math.floor(31*Math.random()+1),t.base_stats.SPDEF[1]=Math.floor(31*Math.random()+1),t.base_stats.SPD[1]=Math.floor(31*Math.random()+1),t.nature=pokemonCore.natures[Math.floor(25*Math.random())],t=pokemonCore.pokemon.statNormFormula(t,"HP"),t=pokemonCore.pokemon.statNormFormula(t,"ATT"),t=pokemonCore.pokemon.statNormFormula(t,"DEF"),t=pokemonCore.pokemon.statNormFormula(t,"SPATT"),t=pokemonCore.pokemon.statNormFormula(t,"SPDEF"),t=pokemonCore.pokemon.statNormFormula(t,"SPD")},calcPokemonStats:function(e){return e=pokemonCore.pokemon.statNormFormula(e,"HP"),e=pokemonCore.pokemon.statNormFormula(e,"ATT"),e=pokemonCore.pokemon.statNormFormula(e,"DEF"),e=pokemonCore.pokemon.statNormFormula(e,"SPATT"),e=pokemonCore.pokemon.statNormFormula(e,"SPDEF"),e=pokemonCore.pokemon.statNormFormula(e,"SPD")},statNormFormula:function(e,t){if("HP"!==t){var a;a=e.nature.INC===t?1.1:e.nature.DEC===t?.9:1,e.stats[t][0]=Math.round(((2*e.base_stats[t][0]+e.base_stats[t][1]+e.base_stats[t][2]/4)*e.level/100+5)*a),e.stats[t][1]=e.stats[t][0]}else e.stats[t][0]=Math.round((2*e.base_stats[t][0]+e.base_stats[t][1]+e.base_stats[t][2]/4)*e.level/100+10+e.level),e.stats[t][1]=e.stats[t][0];return e}},specialInteract:{pokemart:function(e){function t(){var n=1,r=e[a().attr("class")].price;$(document).bind("keydown",function(s){function m(e,t){$(".pokemart-gui .amount .amount-buy").text("x"+e),$(".pokemart-gui .amount .amount-price").text("$"+e*t)}var p=$('li[data-selected="true"]');switch(s.which){case 38:p.prev().length>0&&(p.prev().attr("data-selected","true"),p.attr("data-selected","false"),$(".pokemart-gui .item-img").css("background-image","url(resource/images/items/"+e[p.prev().attr("class")].img+".png)"),$(".pokemart-gui .item-desc").text(""),$(".pokemart-gui .item-desc").prepend(e[p.prev().attr("class")].desc),p.index()>3&&$(".pokemart-gui .items > li").length-2>p.index()&&(o-=74.5,$(".pokemart-gui .items").scrollTop(o)));break;case 40:p.next().length>0&&(p.next().attr("data-selected","true"),p.attr("data-selected","false"),$(".pokemart-gui .item-img").css("background-image","url(resource/images/items/"+e[p.next().attr("class")].img+".png)"),$(".pokemart-gui .item-desc").text(""),$(".pokemart-gui .item-desc").prepend(e[p.next().attr("class")].desc),p.index()>2&&$(".pokemart-gui .items > li").length-3>p.index()&&(o+=74.5,$(".pokemart-gui .items").scrollTop(o)));break;case 32:"item-name cancel"===a().find(".item-name").attr("class")?($(document).unbind("keydown"),$(".pokemart-gui").remove(),pokemonCore.player.bindMovement(),$(".pokemart-gui .money").append("$"+pokemonCore.gameChar.getMoney()),e.pop()):($(document).unbind("keydown"),pokemonCore.utils.createEmptyDialog(e[a().attr("class")].name+"? Certainly. How many would you like?"),$(".pokemart-gui").append('<div class="in-bag"><span>IN BAG:</span><span class="items-bag"></span></div><div class="amount"><span class="amount-buy"></span><span class="amount-price"></span></div>'),$(".pokemart-gui .in-bag .items-bag").text(pokemonCore.gameChar.getItemAmount(e[a().attr("class")].name)),m(1,e[a().attr("class")].price),$(document).bind("keydown",function(o){switch(o.which){case 32:for(var s=0;n+1>s;s++)e[a().attr("class")].buy(),$(".pokemart-gui .money").text("$"+pokemonCore.gameChar.getMoney());$(".pokemart-gui .in-bag").remove(),$(".pokemart-gui .amount").remove(),$(".speech").remove(),$(document).unbind("keydown"),t();break;case 38:n++,n*r<=pokemonCore.gameChar.getMoney()?m(n,r):(n=1,m(n,r));break;case 40:n--,0==n?(n=pokemonCore.gameChar.getMoney()/r,m(n,r)):m(n,r)}}))}})}function a(){return $('li[data-selected="true"]')}var o=0;$(document).unbind("keydown"),$gameDiv.append('<div class="pokemart-gui"><ul class="items"></ul><div class="money"></div><div class="item-img"></div><div class="item-desc"></div></div>'),$(".pokemart-gui .money").append("$"+pokemonCore.gameChar.getMoney());for(var n=0;n<e.length;n++)$(".items").append('<li class="'+n+'"><div class="wrapper"><span class="item-name"></span><span class="item-cost"></span></div></li>'),$("li."+n+" .item-name").prepend(e[n].name),$("li."+n+" .item-cost").prepend("$"+e[n].price);e.push(new pokemonCore.item("Cancel","","","Quit shopping.","quit")),$(".items").append('<li class="'+(e.length-1)+'"><div class="wrapper"><span class="item-name cancel"></span><span class="item-cost"></span></div></li>'),$("li."+(e.length-1)+" .item-name").prepend("Cancel"),$("li.0").attr("data-selected","true"),$(".pokemart-gui .item-img").css("background-image","url(resource/images/items/"+e[0].img+".png)"),$(".pokemart-gui .item-desc").prepend(e[0].desc),t()}},item:function(e,t,a,o,n,r){this.name=e,this.use=t,this.price=a,this.desc=o,this.img=e,this.amount=0,this.type=r,"undefined"!=typeof n&&(this.img=n),this.buy=function(){pokemonCore.gameChar.getMoney()>=this.price&&("undefined"!=pokemonCore.gameChar.getItemByName(this.name)&&void 0!=pokemonCore.gameChar.getItemByName(this.name)?(pokemonCore.gameChar.setMoney(-this.price),pokemonCore.gameChar.getItemByName(this.name).amount+=1):pokemonCore.gameChar.bag.push(this))}},items:{instantiate:function(e){return $.ajax({async:!1,url:"resource/items/"+e+".js",dataType:"script"}),new pokemonCore.item(item.name,item.use,item.price,item.desc,item.img,item.type)},complicatedItemUses:{pokeball:function(e){var t,a=pokemonCore.battle.encounter.pokemon.stats.HP[0],o=pokemonCore.battle.encounter.pokemon.stats.HP[1],n=pokemonCore.battle.encounter.pokemon.catchRate,r=1,s=(3*a-2*o)*n*e/(3*a)*r,m=0,p="";$(".action-box").remove(),$(document).unbind("keydown"),$(".bag-gui").remove(),$(".battle-screen .enemy-pokemon").attr("data-ball","true"),$(".battle-screen .enemy-pokemon").attr("data-image","1"),function i(){setTimeout(function(){var e=Math.floor(65535*Math.random());t=Math.round(1048560/Math.sqrt(Math.sqrt(16711680/s))),e>=t?($(".battle-screen .enemy-pokemon").attr("data-ball","false"),$(".battle-screen .enemy-pokemon").attr("data-image","-"),$(".action-menu").append('<div class="action-box"><span class="fight" data-selected="true">FIGHT</span><span class="bag" data-selected="false">BAG</span><span class="pokemon" data-selected="false">POK&eacute;MON</span><span class="run" data-selected="false">RUN</span></div>'),pokemonCore.battle.setBattleKeybinds(".action-menu")):(m++,"right"==p?($(".enemy-pokemon").attr("data-shake","left"),p="left"):($(".enemy-pokemon").attr("data-shake","right"),p="right"),setTimeout(function(){$(".enemy-pokemon").attr("data-shake","-")},800),m>3?(pokemonCore.gameChar.bagPkmn.length<6?pokemonCore.gameChar.bagPkmn.push(pokemonCore.battle.encounter.pokemon):pokemonCore.gameChar.pcPkmn.push(pokemonCore.battle.encounter.pokemon),$(".action-menu").text(""),pokemonCore.utils.writer(0,function(){setTimeout(function(){$(".action-menu").text(""),pokemonCore.utils.writer(0,function(){setTimeout(function(){var e=pokemonCore.battle.encounter.pokemon;$("#game").append('<div class="poke-info"><div class="pokemon-image"></div><div class="no"></div><div class="type"></div><div class="height"></div><div class="weight"></div><div class="foot"></div><div class="summary"></div></div>'),$(".poke-info .no").text(e.nN+" "+e.name),$(".poke-info .type").text(e.species),$(".poke-info .height").text(e.height),$(".poke-info .weight").text(e.weight),$(".poke-info .foot").css("background-image","url(resource/images/footprint/"+e.nN+".png)"),$(".poke-info .pokemon-image").css("background-image","url(resource/images/pokemon/"+e.nN+".png)"),$(".poke-info .summary").text(e.entry),$(document).bind("keydown",function(e){32==e.which&&($(".poke-info").remove(),pokemonCore.battle.stopBattle(),$(document).unbind("keydown"),pokemonCore.player.bindMovement())})},900)},pokemonCore.battle.encounter.pokemon.name+"'s data was added to the POKeDEX.")},500)},"Gotcha! "+pokemonCore.battle.encounter.pokemon.name+" was Caught!")):i())},1200)}()}}},natures:[{name:"Hardy",INC:"",DEC:""},{name:"Lonely",INC:"ATT",DEC:"DEF"},{name:"Brave",INC:"ATT",DEC:"SPD"},{name:"Adamant",INC:"ATT",DEC:"SPATT"},{name:"Naughty",INC:"ATT",DEC:"SPDEF"},{name:"Bold",INC:"DEF",DEC:"ATT"},{name:"Docile",INC:"",DEC:""},{name:"Relaxed",INC:"DEF",DEC:"SPD"},{name:"Impish",INC:"DEF",DEC:"SPATT"},{name:"Lax",INC:"DEF",DEC:"SPDEF"},{name:"Timid",INC:"SPD",DEC:"ATT"},{name:"Hasty",INC:"SPD",DEC:"DEF"},{name:"Serious",INC:"",DEC:""},{name:"Jolly",INC:"SPD",DEC:"SPATT"},{name:"Naive",INC:"SPD",DEC:"DEF"},{name:"Modest",INC:"SPATT",DEC:"ATT"},{name:"Mild",INC:"SPATT",DEC:"DEF"},{name:"Quiet",INC:"SPATT",DEC:"SPD"},{name:"Bashful",INC:"",DEC:""},{name:"Rash",INC:"SPATT",DEC:"SPDEF"},{name:"Calm",INC:"SPDEF",DEC:"ATT"},{name:"Gentle",INC:"SPDEF",DEC:"DEF"},{name:"Sassy",INC:"SPDEF",DEC:"SPD"},{name:"Careful",INC:"SPDEF",DEC:"SPATT"},{name:"Quirky",INC:"",DEC:""}]};